# Отчет

## Идея рекоммендера

Мы убедились на семинарах, что нейросетевой рекоммендер лучше остальных. Поэтому я попробовал поэкспериментировать с ним - обучить рекоммендер как в статье *Neural Collaborative Filtering*, где мы обсуждали использование сконкатенированных слоев полносвязной нейросети и поэлементного (point-wise) умножения для аппроксимации скалярного произведения. К сожалению, ни вариант с обучением `user`-`item` эмбеддингов как в статье, ни вариант с обучением `prev_track`-`next_track` эмбеддингов не дал ожидаемого прироста. Данные, полученные таким образом лежат в `data/my_recs_custom_neumf.json`. Однако в окончательной версии все же получилось добиться значительного улучшения за счет эвристик с нейросетевым рекомендером (в котором скалярное произведение). Во-первых, для каждого пользователя я храню buffer из $k$ последних прослушанных треков с их `id` и временем. Таким образом, если последние несколько треков из буффера (например 2-3) оказались совсем неудачными - будем рекомендовать на основе лучшего из буффера. Чтобы это был не просто первый трек (т.к. такое может быть ведь он снова может попадать в буффер), будем следить за частотой рекомендаций треков из буффера и фильтровать дубликаты. Также из соображений здравого смысла - лучше использовать в качестве `fallback` `TopPop` рекоммендер (хотя в рамках 1000 сессий разницы не было).

Слайды лекций лежат в папке [slides](../slides).

## Результаты 



